---
import BaseLayout from '../../../components/layout/BaseLayout.astro';
import Breadcrumbs from '../../../components/Breadcrumbs.astro';
import { languagesList, getTranslations, type Language } from '../../../lib/i18n';

export function getStaticPaths() {
  return languagesList.map(lang => ({
    params: { lang },
    props: { lang }
  }));
}

const { lang } = Astro.props as { lang: Language };
const t = getTranslations(lang);

const pageContent = {
  no: {
    title: "Blogg & Innsikt",
    subtitle: "Tips, trender og innsikt fra våre eksperter",
    meta_title: "Blogg | Nexify CRM Systems",
    meta_description: "Les våre siste artikler om webutvikling, design og digital markedsføring.",
    featured: "Fremhevet",
    read_more: "Les mer",
    min_read: "min lesing",
    categories: {
      all: "Alle",
      web: "Webutvikling",
      design: "Design",
      marketing: "Markedsføring",
      business: "Forretning"
    }
  },
  en: {
    title: "Blog & Insights",
    subtitle: "Tips, trends and insights from our experts",
    meta_title: "Blog | Nexify CRM Systems",
    meta_description: "Read our latest articles on web development, design and digital marketing.",
    featured: "Featured",
    read_more: "Read more",
    min_read: "min read",
    categories: {
      all: "All",
      web: "Web Development",
      design: "Design",
      marketing: "Marketing",
      business: "Business"
    }
  },
  ar: {
    title: "المدونة والرؤى",
    subtitle: "نصائح واتجاهات ورؤى من خبرائنا",
    meta_title: "المدونة | Nexify CRM Systems",
    meta_description: "اقرأ أحدث مقالاتنا حول تطوير الويب والتصميم والتسويق الرقمي.",
    featured: "مميز",
    read_more: "اقرأ المزيد",
    min_read: "دقيقة قراءة",
    categories: {
      all: "الكل",
      web: "تطوير الويب",
      design: "التصميم",
      marketing: "التسويق",
      business: "الأعمال"
    }
  }
};

const content = pageContent[lang as keyof typeof pageContent] || pageContent.no;

// Blog articles
const articles = [
  {
    slug: "web-design-trends-2025",
    title: {
      no: "Webtrender 2025: Hva du trenger å vite",
      en: "Web Design Trends 2025: What You Need to Know",
      ar: "اتجاهات تصميم الويب 2025: ما تحتاج معرفته"
    },
    excerpt: {
      no: "Utforsk de nyeste trendene innen webdesign som vil dominere 2025, fra AI-drevet design til immersive opplevelser.",
      en: "Explore the latest web design trends that will dominate 2025, from AI-driven design to immersive experiences.",
      ar: "استكشف أحدث اتجاهات تصميم الويب التي ستهيمن على 2025، من التصميم المدعوم بالذكاء الاصطناعي إلى التجارب الغامرة."
    },
    category: "design",
    image: "/images/blog/web-trends.jpg",
    author: "Sara Johansen",
    date: "2025-01-15",
    readTime: 8,
    featured: true
  },
  {
    slug: "ecommerce-conversion-tips",
    title: {
      no: "10 Tips for å øke konverteringen i nettbutikken din",
      en: "10 Tips to Boost Your E-commerce Conversion Rate",
      ar: "10 نصائح لزيادة معدل التحويل في متجرك الإلكتروني"
    },
    excerpt: {
      no: "Lær hvordan du kan optimalisere nettbutikken din for bedre konvertering og økt salg med disse velprøvde strategiene.",
      en: "Learn how to optimize your online store for better conversion and increased sales with these proven strategies.",
      ar: "تعلم كيفية تحسين متجرك الإلكتروني لتحويل أفضل وزيادة المبيعات مع هذه الاستراتيجيات المثبتة."
    },
    category: "business",
    image: "/images/blog/ecommerce.jpg",
    author: "Tamer Barakat",
    date: "2025-01-10",
    readTime: 6,
    featured: false
  },
  {
    slug: "seo-guide-beginners",
    title: {
      no: "SEO-guide for nybegynnere: Alt du trenger å vite",
      en: "SEO Guide for Beginners: Everything You Need to Know",
      ar: "دليل SEO للمبتدئين: كل ما تحتاج معرفته"
    },
    excerpt: {
      no: "En komplett guide til søkemotoroptimalisering for de som er nye i digital markedsføring.",
      en: "A complete guide to search engine optimization for those new to digital marketing.",
      ar: "دليل شامل لتحسين محركات البحث للمبتدئين في التسويق الرقمي."
    },
    category: "marketing",
    image: "/images/blog/seo.jpg",
    author: "Erik Nordmann",
    date: "2025-01-05",
    readTime: 12,
    featured: false
  },
  {
    slug: "react-vs-nextjs",
    title: {
      no: "React vs Next.js: Hvilken bør du velge?",
      en: "React vs Next.js: Which Should You Choose?",
      ar: "React مقابل Next.js: أيهما يجب أن تختار؟"
    },
    excerpt: {
      no: "En detaljert sammenligning av React og Next.js for å hjelpe deg med å velge riktig teknologi for ditt neste prosjekt.",
      en: "A detailed comparison of React and Next.js to help you choose the right technology for your next project.",
      ar: "مقارنة تفصيلية بين React و Next.js لمساعدتك في اختيار التقنية المناسبة لمشروعك القادم."
    },
    category: "web",
    image: "/images/blog/react-nextjs.jpg",
    author: "Erik Nordmann",
    date: "2024-12-28",
    readTime: 10,
    featured: false
  },
  {
    slug: "ux-design-principles",
    title: {
      no: "5 UX-designprinsipper som øker brukerengasjement",
      en: "5 UX Design Principles That Boost User Engagement",
      ar: "5 مبادئ تصميم UX تزيد من تفاعل المستخدمين"
    },
    excerpt: {
      no: "Oppdag de viktigste UX-prinsippene som vil hjelpe deg med å skape mer engasjerende digitale opplevelser.",
      en: "Discover the key UX principles that will help you create more engaging digital experiences.",
      ar: "اكتشف مبادئ UX الرئيسية التي ستساعدك في إنشاء تجارب رقمية أكثر جاذبية."
    },
    category: "design",
    image: "/images/blog/ux-design.jpg",
    author: "Sara Johansen",
    date: "2024-12-20",
    readTime: 7,
    featured: false
  },
  {
    slug: "small-business-website",
    title: {
      no: "Hvorfor småbedrifter trenger en profesjonell nettside",
      en: "Why Small Businesses Need a Professional Website",
      ar: "لماذا تحتاج الشركات الصغيرة إلى موقع ويب احترافي"
    },
    excerpt: {
      no: "Lær hvorfor en profesjonell nettside er avgjørende for småbedrifters suksess i dagens digitale verden.",
      en: "Learn why a professional website is crucial for small business success in today's digital world.",
      ar: "تعلم لماذا الموقع الإلكتروني الاحترافي ضروري لنجاح الشركات الصغيرة في عالم اليوم الرقمي."
    },
    category: "business",
    image: "/images/blog/small-business.jpg",
    author: "Maria Hansen",
    date: "2024-12-15",
    readTime: 5,
    featured: false
  }
];

const featuredArticle = articles.find(a => a.featured);
const regularArticles = articles.filter(a => !a.featured);

const breadcrumbItems = [
  { label: lang === 'ar' ? 'الرئيسية' : lang === 'en' ? 'Home' : 'Hjem', href: `/${lang}` },
  { label: content.title }
];

function formatDate(dateStr: string, locale: string) {
  const date = new Date(dateStr);
  const localeMap: Record<string, string> = { no: 'nb-NO', en: 'en-US', ar: 'ar-SA' };
  return date.toLocaleDateString(localeMap[locale] || 'nb-NO', { 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric' 
  });
}
---

<BaseLayout lang={lang} page="blog" title={content.meta_title} description={content.meta_description}>
  <!-- Hero Section -->
  <section class="relative pt-32 pb-16 bg-gradient-to-br from-primary-600 via-primary-700 to-secondary-600 overflow-hidden">
    <div class="absolute inset-0 opacity-10">
      <div class="absolute top-20 left-10 w-72 h-72 bg-white rounded-full blur-3xl"></div>
      <div class="absolute bottom-20 right-10 w-96 h-96 bg-secondary-400 rounded-full blur-3xl"></div>
    </div>
    
    <div class="container mx-auto px-4 relative z-10">
      <Breadcrumbs lang={lang} items={breadcrumbItems} />
      
      <div class="max-w-4xl mx-auto text-center mt-8">
        <h1 class="text-4xl md:text-6xl font-bold text-white mb-6 animate-fade-up">
          {content.title}
        </h1>
        <p class="text-xl md:text-2xl text-white/90 animate-fade-up" style="animation-delay: 0.1s">
          {content.subtitle}
        </p>
      </div>
    </div>
    
    <div class="absolute bottom-0 left-0 right-0">
      <svg viewBox="0 0 1440 120" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full">
        <path d="M0 120L60 105C120 90 240 60 360 45C480 30 600 30 720 37.5C840 45 960 60 1080 67.5C1200 75 1320 75 1380 75L1440 75V120H1380C1320 120 1200 120 1080 120C960 120 840 120 720 120C600 120 480 120 360 120C240 120 120 120 60 120H0Z" fill="white" class="dark:fill-gray-900"/>
      </svg>
    </div>
  </section>

  <!-- Category Filter -->
  <section class="py-8 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 sticky top-16 z-20">
    <div class="container mx-auto px-4">
      <div class="flex flex-wrap gap-3 justify-center">
        {Object.entries(content.categories).map(([key, label]) => (
          <button 
            class={`px-5 py-2 rounded-full text-sm font-medium transition-all ${
              key === 'all' 
                ? 'bg-primary-600 text-white' 
                : 'bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-primary-100 dark:hover:bg-primary-900/30'
            }`}
            data-category={key}
          >
            {label}
          </button>
        ))}
      </div>
    </div>
  </section>

  <!-- Featured Article -->
  {featuredArticle && (
    <section class="py-12 bg-white dark:bg-gray-900">
      <div class="container mx-auto px-4">
        <a href={`/${lang}/blog/${featuredArticle.slug}`} class="group block">
          <div class="relative bg-gradient-to-br from-primary-500 to-secondary-500 rounded-3xl overflow-hidden shadow-2xl">
            <div class="grid md:grid-cols-2 gap-8 p-8 md:p-12">
              <div class="flex flex-col justify-center">
                <span class="inline-flex items-center gap-2 text-white/80 text-sm mb-4">
                  <span class="px-3 py-1 bg-white/20 rounded-full">{content.featured}</span>
                  <span>{featuredArticle.readTime} {content.min_read}</span>
                </span>
                <h2 class="text-3xl md:text-4xl font-bold text-white mb-4 group-hover:underline decoration-2 underline-offset-4">
                  {featuredArticle.title[lang as keyof typeof featuredArticle.title] || featuredArticle.title.no}
                </h2>
                <p class="text-white/90 text-lg mb-6">
                  {featuredArticle.excerpt[lang as keyof typeof featuredArticle.excerpt] || featuredArticle.excerpt.no}
                </p>
                <div class="flex items-center gap-4">
                  <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
                    <span class="text-white font-bold">{featuredArticle.author.split(' ').map(n => n[0]).join('')}</span>
                  </div>
                  <div>
                    <div class="text-white font-medium">{featuredArticle.author}</div>
                    <div class="text-white/70 text-sm">{formatDate(featuredArticle.date, lang)}</div>
                  </div>
                </div>
              </div>
              <div class="relative h-64 md:h-auto rounded-2xl overflow-hidden bg-white/10">
                <div class="absolute inset-0 flex items-center justify-center">
                  <svg class="w-24 h-24 text-white/30" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </a>
      </div>
    </section>
  )}

  <!-- Articles Grid -->
  <section class="py-16 bg-gray-50 dark:bg-gray-800">
    <div class="container mx-auto px-4">
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        {regularArticles.map((article, index) => (
          <article 
            class="group scroll-animate" 
            data-animation="fade-up" 
            style={`--delay: ${index * 0.1}s`}
            data-category={article.category}
          >
            <a href={`/${lang}/blog/${article.slug}`} class="block h-full">
              <div class="bg-white dark:bg-gray-900 rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-500 h-full flex flex-col group-hover:-translate-y-2">
                <!-- Image -->
                <div class="relative h-48 bg-gradient-to-br from-gray-200 to-gray-300 dark:from-gray-700 dark:to-gray-600 overflow-hidden">
                  <div class="absolute inset-0 flex items-center justify-center">
                    <svg class="w-16 h-16 text-gray-400 dark:text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
                    </svg>
                  </div>
                  <!-- Category Badge -->
                  <span class="absolute top-4 left-4 px-3 py-1 bg-primary-600 text-white text-xs font-medium rounded-full">
                    {content.categories[article.category as keyof typeof content.categories]}
                  </span>
                </div>
                
                <!-- Content -->
                <div class="p-6 flex-1 flex flex-col">
                  <div class="flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mb-3">
                    <span>{formatDate(article.date, lang)}</span>
                    <span>•</span>
                    <span>{article.readTime} {content.min_read}</span>
                  </div>
                  
                  <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3 group-hover:text-primary-600 transition-colors line-clamp-2">
                    {article.title[lang as keyof typeof article.title] || article.title.no}
                  </h3>
                  
                  <p class="text-gray-600 dark:text-gray-300 mb-4 flex-1 line-clamp-3">
                    {article.excerpt[lang as keyof typeof article.excerpt] || article.excerpt.no}
                  </p>
                  
                  <!-- Author -->
                  <div class="flex items-center justify-between pt-4 border-t border-gray-100 dark:border-gray-700">
                    <div class="flex items-center gap-3">
                      <div class="w-8 h-8 bg-primary-100 dark:bg-primary-900/30 rounded-full flex items-center justify-center">
                        <span class="text-primary-600 text-sm font-bold">{article.author.split(' ').map(n => n[0]).join('')}</span>
                      </div>
                      <span class="text-sm text-gray-700 dark:text-gray-300">{article.author}</span>
                    </div>
                    <span class="text-primary-600 font-medium text-sm group-hover:underline">
                      {content.read_more} →
                    </span>
                  </div>
                </div>
              </div>
            </a>
          </article>
        ))}
      </div>
    </div>
  </section>

  <!-- Newsletter CTA -->
  <section class="py-20 bg-gradient-to-r from-primary-600 to-secondary-600">
    <div class="container mx-auto px-4 text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">
        {lang === 'ar' ? 'اشترك في نشرتنا الإخبارية' : lang === 'en' ? 'Subscribe to Our Newsletter' : 'Abonner på vårt nyhetsbrev'}
      </h2>
      <p class="text-xl text-white/90 mb-8 max-w-2xl mx-auto">
        {lang === 'ar' ? 'احصل على أحدث المقالات والنصائح مباشرة في بريدك الإلكتروني' : lang === 'en' ? 'Get the latest articles and tips delivered directly to your inbox' : 'Få de nyeste artiklene og tipsene rett i innboksen din'}
      </p>
      <form class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto">
        <input 
          type="email" 
          placeholder={lang === 'ar' ? 'بريدك الإلكتروني' : lang === 'en' ? 'Your email' : 'Din e-post'}
          class="flex-1 px-6 py-4 rounded-full text-gray-900 focus:outline-none focus:ring-4 focus:ring-white/30"
        />
        <button 
          type="submit"
          class="px-8 py-4 bg-white text-primary-600 rounded-full font-semibold hover:bg-gray-100 transition-all hover:scale-105"
        >
          {lang === 'ar' ? 'اشترك' : lang === 'en' ? 'Subscribe' : 'Abonner'}
        </button>
      </form>
    </div>
  </section>
</BaseLayout>

<style>
  @keyframes fade-up {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .animate-fade-up {
    animation: fade-up 0.6s ease-out forwards;
  }
  
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
